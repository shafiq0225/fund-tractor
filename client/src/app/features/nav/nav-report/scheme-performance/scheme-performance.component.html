<!-- Breadcrumb -->
<app-breadcrumb [links]="[{ label: 'AMFI Performance Report', route: '/nav/report', icon: 'dashboard' }]"
    current="AMFI Data Import">
</app-breadcrumb>

<!-- nav-performance.component.html -->
<div class="nav-performance-container">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
        <div class="spinner-container">
            <div class="spinner"></div>
            <p>Loading NAV performance data...</p>
        </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
        <div class="error-content">
            <div class="error-icon">‚ö†Ô∏è</div>
            <h3>Unable to Load Data</h3>
            <p>{{ error }}</p>
            <button class="retry-btn" (click)="refreshData()">
                <span class="btn-icon">üîÑ</span>
                Try Again
            </button>
        </div>
    </div>

    <!-- Success State -->
    <div *ngIf="schemePerformance && !loading" class="performance-content">
        <!-- Header with last updated -->
        <div class="content-header">
            <div class="last-updated">
                Last updated: {{ lastUpdated | date:'dd-MMM-yyyy' }}
            </div>
            <button class="refresh-btn" (click)="refreshData()" title="Refresh data">
                üîÑ Refresh
            </button>
        </div>

        <!-- Scheme Header -->
        <div class="scheme-header">
            <div class="scheme-info">
                <h1 class="scheme-name">{{ schemePerformance.schemeName }}</h1>
                <div class="scheme-details">
                    <span class="fund-house">{{ schemePerformance.fundHouse }}</span>
                    <span class="divider">‚Ä¢</span>
                    <span class="scheme-code">Scheme Code: {{ schemePerformance.schemeCode }}</span>
                </div>
            </div>
            <div class="current-nav">
                <div class="nav-value">{{ schemePerformance.currentNav | number:'1.2-4' }}</div>
                <div class="nav-date">As of {{ schemePerformance.lastUpdated | date:'fullDate' }}</div>
            </div>
        </div>

        <!-- Performance Metrics Carousel -->
        <div class="performance-section">
            <h2 class="section-title">Performance Overview</h2>
            
            <!-- Carousel Container -->
            <div class="carousel-container">
                <!-- Navigation Buttons - Only show if we have more than visible cards -->
                <button *ngIf="performanceMetrics.length > slidesToShow" 
                        class="carousel-btn prev-btn" 
                        (click)="slidePrev()" 
                        title="Previous"
                        [disabled]="currentSlide === 0">
                    ‚Äπ
                </button>
                
                <!-- Carousel Wrapper -->
                <div class="carousel-wrapper">
                    <div class="carousel-track" [style.transform]="'translateX(' + currentSlide * -slideWidth + '%)'">
                        <div class="carousel-slide" *ngFor="let metric of performanceMetrics; let i = index">
                            <app-performance-card [metric]="metric" class="carousel-card"></app-performance-card>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons - Only show if we have more than visible cards -->
                <button *ngIf="performanceMetrics.length > slidesToShow" 
                        class="carousel-btn next-btn" 
                        (click)="slideNext()" 
                        title="Next"
                        [disabled]="currentSlide >= performanceMetrics.length - slidesToShow">
                    ‚Ä∫
                </button>
            </div>

            <!-- Carousel Indicators - Only show if we have more than visible cards -->
            <div *ngIf="performanceMetrics.length > slidesToShow" class="carousel-indicators">
                <button *ngFor="let item of getVisibleSlides(); let i = index" 
                        class="indicator" 
                        [class.active]="i === currentSlide"
                        (click)="goToSlide(i)"
                        [attr.aria-label]="'Go to slide ' + (i + 1)">
                </button>
            </div>
        </div>

        <!-- Rest of your content remains the same -->
        <!-- Performance Summary -->
        <div *ngIf="performanceSummary" class="performance-summary">
            <h2 class="section-title">Performance Summary</h2>
            <div class="summary-cards">
                <div class="summary-card" [class]="getTrendClass(performanceSummary.overallTrend)">
                    <div class="summary-icon">
                        {{ getTrendIcon(performanceSummary.overallTrend) }}
                    </div>
                    <div class="summary-content">
                        <span class="summary-label">Overall Trend</span>
                        <span class="summary-value">
                            {{ performanceSummary.overallTrend | titlecase }}
                        </span>
                    </div>
                </div>

                <div class="summary-card trend-up">
                    <div class="summary-icon">üèÜ</div>
                    <div class="summary-content">
                        <span class="summary-label">Best Performer</span>
                        <span class="summary-value">{{ performanceSummary.bestPerformer }}</span>
                    </div>
                </div>

                <div class="summary-card trend-down">
                    <div class="summary-icon">üìâ</div>
                    <div class="summary-content">
                        <span class="summary-label">Worst Performer</span>
                        <span class="summary-value">{{ performanceSummary.worstPerformer }}</span>
                    </div>
                </div>

                <div class="summary-card total-return">
                    <div class="summary-icon">üí∞</div>
                    <div class="summary-content">
                        <span class="summary-label">1 Year Return</span>
                        <span class="summary-value" [class.positive]="performanceSummary.totalReturn > 0"
                            [class.negative]="performanceSummary.totalReturn < 0">
                            {{ performanceSummary.totalReturn > 0 ? '+' : '' }}{{ performanceSummary.totalReturn }}%
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Historical NAV Chart -->
        <div class="historical-section" *ngIf="schemePerformance">
            <h2 class="section-title">Historical NAV Trend</h2>
            <app-nav-chart [historicalData]="schemePerformance.historicalData" [chartType]="'line'">
            </app-nav-chart>
        </div>
    </div>
</div>